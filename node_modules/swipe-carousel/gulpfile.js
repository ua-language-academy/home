'use strict';

var babel = require('gulp-babel');
var gulp = require('gulp');
var gutil = require('gulp-util');
var eslint = require('gulp-eslint');
var sourcemaps = require('gulp-sourcemaps');

var src = [
  './**/*.js',
  './**/*.jsx',
  '!lib/**/**',
  '!node_modules/**/**'
];

gulp.task('babel', function () {
  return gulp.src(src)
    .pipe(sourcemaps.init())
    .pipe(babel())
    .pipe(sourcemaps.write('.', {
      sourceRoot: __dirname,
      includeContent: false
    }))
    .pipe(gulp.dest('lib'));
});

gulp.task('lint', function () {
  return gulp.src(src)
    // eslint() attaches the lint output to the eslint property
    // of the file object so it can be used by other modules.
    .pipe(eslint({ useEslintrc: true }))
    // eslint.format() outputs the lint results to the console.
    // Alternatively use eslint.formatEach() (see Docs).
    .pipe(eslint.format())
    // To have the process exit with an error code (1) on
    // lint error, return the stream and pipe to failOnError last.
    .pipe(eslint.failAfterError());
});

gulp.task('default', function () {
  gutil.log('No default task configured. Run gulp --tasks-simple to view available commands.');
});
